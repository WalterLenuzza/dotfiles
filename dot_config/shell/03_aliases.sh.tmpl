#!/usr/bin/env sh

## Shared shell settings (bash/zsh)
## Aliases

# Aliases: colorize list files
if [[ $(uname) == "Darwin" ]]; then
  # Colorize ls
  export CLICOLOR=1
  # Always show colors (with less and grep), Experimental
  export CLICOLOR_FORCE=1
elif [[ $(uname) == "Linux" ]]; then
  alias ls='ls --color=auto'
fi

# Load dircolors
if [[ "$(command -v dircolors)" && -f "$XDG_CONFIG_HOME"/dircolors ]]; then
  eval $(dircolors -b "$XDG_CONFIG_HOME"/dircolors)
fi

# # Aliases: colorize grep files
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'

# colored GCC warnings and errors
export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'

# Aliases: list files
if [ "$(command -v exa)" ]; then
  alias v='exa -a --git --long --header --time-style=long-iso'                     # Long listing
  alias vs='exa -a --git --long --header --time-style=long-iso --sort=size'        # Sort by size
  alias vt='exa -a --git --long --header --time-style=long-iso --sort=oldest'      # Sort by mtime-reversed
  alias vx='exa -a --git --long --header --time-style=long-iso --group --extended' # Show ACLs and xattrs
  alias tree='exa -a --ignore-glob=".git" --tree'
else
  alias la='ls -A'
  alias v='ls -lhA'    # Long listing
  alias vs='ls -lhASr' # Sort by size-reversed
  alias vt='ls -lhAtr' # Sort by mtime-reversed
  alias vx='ls -lhAe@' # Show ACLs and xattrs
  alias tree='tree -aC -I .git --dirsfirst'
fi

# Aliases: disk usage
if [ "$(command -v ncdu)" ]; then
  alias d='ncdu'
else
  alias d='du -csh | sort -nk'
fi

# Aliases: misc
alias df='df -h'
alias ln='ln -v'
alias mkdir='mkdir -p'
alias mv='mv -vi'
alias p='ps fax'
alias rm='rm -v'

alias mc='mc -a'
alias tmux='tmux -2'

alias rg='ag'
alias ack='ag'

alias clean_DS_Store='find . -name *.DS_Store -type f -print -delete'
alias dotfiles='chezmoi'

# OS specifics
if [[ $(uname) == "Darwin" ]]; then
  alias yay='brew'
  alias ps='pstree'
elif [[ $(uname) == "Linux" ]]; then
  alias yay-install='yay -Sy --needed --noconfirm - < "$XDG_CONFIG_HOME"/yay/packagelist'
  alias yay-upgrade='yay -Syu --devel --timeupdate'

  # Set default browser
  export BROWSER='firefox'
fi

# Default programs

[ "$(command -v htop)" ] && {
  alias top='htop'
}

if [ "$(command -v most)" ]; then
  export PAGER='most'
  alias less='most'
else
  export PAGER='less'
  export LESS='-FMnqrX'
fi

# Editor
[ "$(command -v vim)" ] && {
  alias vi='vim'
  alias vim='vim'
  export EDITOR='vim'
  export VISUAL='vim'
}

[ "$(command -v nvim)" ] && {
  alias vi='nvim'
  alias vim='nvim'
  export EDITOR='nvim'
  export VISUAL='nvim'
}

[ "$(command -v subl)" ] && {
  alias sub='subl -a .'
}

# Diff
[ "$(command -v icdiff)" ] && {
  alias diff='icdiff'
}

# Kubernetes
alias k='kubectl'
